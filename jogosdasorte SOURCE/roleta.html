<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Roleta da Sorte</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Outfit:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0f172a;
      --surface: #1e293b;
      --surface-2: #334155;
      --accent: #f59e0b;
      --accent-hover: #fbbf24;
      --text: #f1f5f9;
      --text-muted: #94a3b8;
      --radius: 16px;
      --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Outfit', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 50% at 50% -20%, rgba(245, 158, 11, 0.12), transparent),
        radial-gradient(ellipse 60% 40% at 100% 100%, rgba(168, 85, 247, 0.08), transparent);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      position: relative;
      z-index: 1;
      max-width: 600px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 12px;
    }

    h1 {
      font-family: 'Fredoka', sans-serif;
      font-size: clamp(1.5rem, 4vw, 2rem);
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent), #fbbf24);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-actions { display: flex; align-items: center; gap: 10px; }

    .btn-voltar {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      font-family: 'Outfit', sans-serif;
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--text);
      background: var(--surface-2);
      border: none;
      border-radius: 10px;
      text-decoration: none;
      transition: background 0.2s, transform 0.2s;
    }
    .btn-voltar:hover {
      background: var(--accent);
      color: var(--bg);
      transform: translateX(-2px);
    }

    .btn-icon {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: none;
      background: var(--surface-2);
      color: var(--text);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s, background 0.2s;
    }
    .btn-icon:hover { background: var(--accent); transform: scale(1.05); }
    .btn-icon svg { width: 24px; height: 24px; }

    /* Nomes */
    .nomes-section {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 20px;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
    }

    .nomes-section h2 {
      font-family: 'Fredoka', sans-serif;
      font-size: 1.1rem;
      margin-bottom: 12px;
      color: var(--text);
    }

    .add-row {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }

    .add-row input {
      flex: 1;
      padding: 12px 14px;
      border-radius: 10px;
      border: 2px solid var(--surface-2);
      background: var(--bg);
      color: var(--text);
      font-size: 1rem;
    }
    .add-row input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .btn-add {
      padding: 12px 20px;
      font-family: 'Outfit', sans-serif;
      font-weight: 600;
      background: var(--accent);
      color: var(--bg);
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn-add:hover { background: var(--accent-hover); }

    .btn-add-varios {
      font-size: 0.85rem;
      padding: 8px 12px;
      background: var(--surface-2);
      color: var(--text);
      margin-bottom: 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.2s;
    }
    .btn-add-varios:hover { background: var(--accent); color: var(--bg); }

    .textarea-wrap {
      display: none;
      margin-bottom: 12px;
    }
    .textarea-wrap.ativo { display: block; }
    .textarea-wrap textarea {
      width: 100%;
      min-height: 80px;
      padding: 10px;
      border-radius: 8px;
      border: 2px solid var(--surface-2);
      background: var(--bg);
      color: var(--text);
      font-size: 0.9rem;
      resize: vertical;
    }

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--surface-2);
      border-radius: 20px;
      font-size: 0.9rem;
    }
    .chip .remove {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      padding: 0 2px;
      font-size: 1.1rem;
      line-height: 1;
      transition: color 0.2s;
    }
    .chip .remove:hover { color: #ef4444; }

    /* Roleta */
    .roleta-section {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 28px;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .wheel-wrap {
      position: relative;
      width: 280px;
      height: 280px;
      margin-bottom: 20px;
    }

    .pointer {
      position: absolute;
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 14px solid transparent;
      border-right: 14px solid transparent;
      border-top: 24px solid var(--accent);
      z-index: 10;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    .wheel {
      position: absolute;
      inset: 20px 0 0 0;
      margin: 0 auto;
      width: 240px;
      height: 240px;
      border-radius: 50%;
      border: 6px solid var(--surface-2);
      box-shadow: inset 0 0 20px rgba(0,0,0,0.3), 0 0 20px rgba(0,0,0,0.2);
      transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
    }

    .wheel.vazio {
      background: var(--surface-2);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 0.95rem;
      text-align: center;
      padding: 20px;
    }

    .resultado {
      min-height: 48px;
      font-family: 'Fredoka', sans-serif;
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--accent);
      text-align: center;
      margin-bottom: 16px;
    }
    .resultado.vazio { color: var(--text-muted); font-weight: 400; font-size: 1rem; }

    .btn-girar {
      padding: 16px 40px;
      font-family: 'Fredoka', sans-serif;
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--bg);
      background: linear-gradient(135deg, var(--accent), #fbbf24);
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(245, 158, 11, 0.4);
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .btn-girar:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 28px rgba(245, 158, 11, 0.5);
    }
    .btn-girar:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .opcao-remover-wrap {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 14px;
      margin-top: 24px;
      padding: 14px 20px;
      background: var(--surface-2);
      border-radius: 12px;
      width: 100%;
      max-width: 320px;
    }
    .opcao-remover-label {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text);
    }
    .opcao-remover-wrap .toggle {
      flex-shrink: 0;
    }

    /* Modal config */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
      padding: 20px;
    }
    .modal-overlay.aberto { opacity: 1; visibility: visible; }
    .modal {
      background: var(--surface);
      border-radius: var(--radius);
      padding: 28px;
      max-width: 380px;
      width: 100%;
      box-shadow: var(--shadow);
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }
    .modal-overlay.aberto .modal { transform: scale(1); }
    .modal h3 {
      font-family: 'Fredoka', sans-serif;
      font-size: 1.25rem;
      margin-bottom: 20px;
    }
    .modal .campo { margin-bottom: 18px; }
    .modal label {
      display: block;
      font-size: 0.9rem;
      color: var(--text-muted);
      margin-bottom: 6px;
    }
    .modal select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 8px;
      border: 1px solid var(--surface-2);
      background: var(--bg);
      color: var(--text);
      font-size: 1rem;
    }
    .toggle-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }
    .toggle {
      width: 48px;
      height: 26px;
      background: var(--surface-2);
      border-radius: 13px;
      position: relative;
      cursor: pointer;
      transition: background 0.2s;
    }
    .toggle.ativo { background: var(--accent); }
    .toggle::after {
      content: '';
      position: absolute;
      width: 22px;
      height: 22px;
      background: #fff;
      border-radius: 50%;
      top: 2px;
      left: 2px;
      transition: transform 0.2s;
    }
    .toggle.ativo::after { transform: translateX(22px); }
    .modal .btn-fechar {
      width: 100%;
      margin-top: 20px;
      padding: 12px;
      font-family: 'Outfit', sans-serif;
      font-weight: 600;
      background: var(--accent);
      color: var(--bg);
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .modal .btn-fechar:hover { background: var(--accent-hover); }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üé° Roleta da Sorte</h1>
      <div class="header-actions">
        <a href="index.html" class="btn-voltar">‚Üê Voltar</a>
        <button type="button" class="btn-icon" id="btn-config" title="Configura√ß√µes" aria-label="Configura√ß√µes">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 2.31.826 1.37 1.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 2.31-1.37 1.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-2.31-.826-1.37-1.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-2.31 1.37-1.37.636.636 1.664.727 2.573 1.065z" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        </button>
      </div>
    </header>

    <section class="nomes-section">
      <h2>Nomes na roleta</h2>
      <div class="add-row">
        <input type="text" id="input-nome" placeholder="Digite um nome e adicione" maxlength="40">
        <button type="button" class="btn-add" id="btn-add">Adicionar</button>
      </div>
      <button type="button" class="btn-add-varios" id="btn-add-varios">+ Adicionar v√°rios (um por linha)</button>
      <div class="textarea-wrap" id="textarea-wrap">
        <textarea id="textarea-nomes" placeholder="Um nome por linha"></textarea>
        <button type="button" class="btn-add" id="btn-confirmar-varios">Adicionar todos</button>
      </div>
      <div class="chips" id="chips"></div>
    </section>

    <section class="roleta-section">
      <div class="wheel-wrap">
        <div class="pointer"></div>
        <div class="wheel" id="wheel"></div>
      </div>
      <div class="resultado vazio" id="resultado">Quem ser√° sorteado?</div>
      <button type="button" class="btn-girar" id="btn-girar">Girar!</button>
      <div class="opcao-remover-wrap">
        <span class="opcao-remover-label">Remover sorteado da lista</span>
        <div class="toggle" id="toggle-remover" role="switch" aria-checked="false" title="Quando ativo, o nome sorteado √© removido da roleta"></div>
      </div>
    </section>
  </div>

  <div class="modal-overlay" id="modal-config">
    <div class="modal">
      <h3>‚öôÔ∏è Prefer√™ncias</h3>
      <div class="campo">
        <label>Dura√ß√£o do giro</label>
        <select id="config-duracao">
          <option value="3">R√°pido (3s)</option>
          <option value="4" selected>Normal (4s)</option>
          <option value="6">Lento (6s)</option>
        </select>
      </div>
      <div class="toggle-row">
        <span>Som ao parar</span>
        <div class="toggle ativo" id="toggle-som" role="switch" aria-checked="true"></div>
      </div>
      <button type="button" class="btn-fechar" id="btn-fechar-config">Fechar</button>
    </div>
  </div>

  <script>
    (function () {
      const CORES = ['#f59e0b', '#3b82f6', '#22c55e', '#a855f7', '#ef4444', '#06b6d4', '#eab308', '#ec4899'];
      let nomes = [];
      let config = {
        duracao: 4,
        som: true,
        removerSorteado: false
      };
      let girando = false;
      let rotacaoAtual = 0;

      const inputNome = document.getElementById('input-nome');
      const btnAdd = document.getElementById('btn-add');
      const btnAddVarios = document.getElementById('btn-add-varios');
      const textareaWrap = document.getElementById('textarea-wrap');
      const textareaNomes = document.getElementById('textarea-nomes');
      const btnConfirmarVarios = document.getElementById('btn-confirmar-varios');
      const chipsEl = document.getElementById('chips');
      const wheelEl = document.getElementById('wheel');
      const resultadoEl = document.getElementById('resultado');
      const btnGirar = document.getElementById('btn-girar');
      const modalEl = document.getElementById('modal-config');
      const btnConfig = document.getElementById('btn-config');
      const btnFecharConfig = document.getElementById('btn-fechar-config');

      function playBeep() {
        if (!config.som) return;
        try {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.frequency.value = 660;
          osc.type = 'sine';
          gain.gain.setValueAtTime(0.15, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
          osc.start(ctx.currentTime);
          osc.stop(ctx.currentTime + 0.2);
        } catch (_) {}
      }

      function renderChips() {
        chipsEl.innerHTML = nomes.map((nome, i) =>
          `<span class="chip" data-i="${i}">${escapeHtml(nome)} <button type="button" class="remove" aria-label="Remover">√ó</button></span>`
        ).join('');
        chipsEl.querySelectorAll('.remove').forEach((btn, i) => {
          btn.addEventListener('click', () => removerNome(i));
        });
      }

      function escapeHtml(s) {
        const div = document.createElement('div');
        div.textContent = s;
        return div.innerHTML;
      }

      function removerNome(index) {
        nomes.splice(index, 1);
        renderChips();
        atualizarWheel();
      }

      function atualizarWheel() {
        const n = nomes.length;
        if (n === 0) {
          wheelEl.className = 'wheel vazio';
          wheelEl.style.background = '';
          wheelEl.style.transform = '';
          wheelEl.innerHTML = 'Adicione nomes acima';
          rotacaoAtual = 0;
          return;
        }
        wheelEl.classList.remove('vazio');
        wheelEl.innerHTML = '';
        const degPorItem = 360 / n;
        const gradient = nomes.map((_, i) => {
          const cor = CORES[i % CORES.length];
          const start = i * degPorItem;
          const end = start + degPorItem;
          return `${cor} ${start}deg ${end}deg`;
        }).join(', ');
        wheelEl.style.background = `conic-gradient(${gradient})`;
        wheelEl.style.transform = `rotate(${rotacaoAtual}deg)`;
      }

      function girar() {
        if (girando || nomes.length === 0) return;
        girando = true;
        btnGirar.disabled = true;
        resultadoEl.textContent = '...';
        resultadoEl.classList.remove('vazio');

        const index = Math.floor(Math.random() * nomes.length);
        const degPorItem = 360 / nomes.length;
        const anguloSorteado = index * degPorItem + degPorItem / 2;
        const voltas = 5 + Math.random() * 2;
        const rotacaoFinal = rotacaoAtual + 360 * voltas + (360 - anguloSorteado);
        rotacaoAtual = rotacaoFinal % 360;

        wheelEl.style.transition = `transform ${config.duracao}s cubic-bezier(0.17, 0.67, 0.12, 0.99)`;
        wheelEl.style.transform = `rotate(${rotacaoFinal}deg)`;

        setTimeout(() => {
          const sorteado = nomes[index];
          resultadoEl.textContent = 'üéâ ' + sorteado + ' üéâ';
          playBeep();
          if (config.removerSorteado) {
            nomes.splice(index, 1);
            rotacaoAtual = 0;
            renderChips();
            atualizarWheel();
          } else {
            rotacaoAtual = rotacaoFinal % 360;
            wheelEl.style.transition = 'none';
            wheelEl.style.transform = `rotate(${rotacaoAtual}deg)`;
          }
          girando = false;
          btnGirar.disabled = false;
        }, config.duracao * 1000);
      }

      function addNome(nome) {
        const t = nome.trim();
        if (!t) return;
        nomes.push(t);
        renderChips();
        atualizarWheel();
      }

      btnAdd.addEventListener('click', () => {
        addNome(inputNome.value);
        inputNome.value = '';
        inputNome.focus();
      });
      inputNome.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          addNome(inputNome.value);
          inputNome.value = '';
        }
      });

      btnAddVarios.addEventListener('click', () => {
        textareaWrap.classList.toggle('ativo');
        if (textareaWrap.classList.contains('ativo')) textareaNomes.focus();
      });

      btnConfirmarVarios.addEventListener('click', () => {
        const linhas = textareaNomes.value.split(/\n/).map(s => s.trim()).filter(Boolean);
        linhas.forEach(addNome);
        textareaNomes.value = '';
        textareaWrap.classList.remove('ativo');
      });

      chipsEl.addEventListener('click', (e) => {
        if (e.target.classList.contains('remove')) return;
        const chip = e.target.closest('.chip');
        if (chip) {
          const i = parseInt(chip.dataset.i, 10);
          if (!isNaN(i)) removerNome(i);
        }
      });

      btnGirar.addEventListener('click', girar);

      btnConfig.addEventListener('click', () => modalEl.classList.add('aberto'));
      btnFecharConfig.addEventListener('click', () => modalEl.classList.remove('aberto'));
      modalEl.addEventListener('click', (e) => { if (e.target === modalEl) modalEl.classList.remove('aberto'); });

      document.getElementById('config-duracao').value = String(config.duracao);
      document.getElementById('config-duracao').addEventListener('change', (e) => {
        config.duracao = parseInt(e.target.value, 10);
      });

      document.getElementById('toggle-som').addEventListener('click', function () {
        config.som = !config.som;
        this.classList.toggle('ativo', config.som);
        this.setAttribute('aria-checked', config.som);
      });

      document.getElementById('toggle-remover').addEventListener('click', function () {
        config.removerSorteado = !config.removerSorteado;
        this.classList.toggle('ativo', config.removerSorteado);
        this.setAttribute('aria-checked', config.removerSorteado);
      });

      atualizarWheel();
    })();
  </script>
</body>
</html>
